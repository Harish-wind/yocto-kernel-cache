From 7a8a783254a01f6c31ebacbc8da5485b1c58148a Mon Sep 17 00:00:00 2001
From: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
Date: Wed, 20 Jul 2022 11:31:02 +0200
Subject: [PATCH 26/55] Revert "printk: Skip console drivers on PREEMPT_RT."

Revert the previous change and allow printing on consoles now that the atomic
consoles and the printing thread is available.

Signed-off-by: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
---
 kernel/printk/printk.c | 10 ----------
 1 file changed, 10 deletions(-)

diff --git a/kernel/printk/printk.c b/kernel/printk/printk.c
index 7c6c9d602ffc..f1f9ce9b23f6 100644
--- a/kernel/printk/printk.c
+++ b/kernel/printk/printk.c
@@ -3297,16 +3297,6 @@ void console_unlock(void)
 		return;
 	}
 
-	/*
-	 * On PREEMPT_RT it is not possible to invoke console drivers with
-	 * disabled interrupts and or preemption. Therefore all drivers are
-	 * skipped and the output can be retrieved from the buffer.
-	 */
-	if (IS_ENABLED(CONFIG_PREEMPT_RT)) {
-		__console_unlock();
-		return;
-	}
-
 	/*
 	 * Console drivers are called with interrupts disabled, so
 	 * @console_may_schedule should be cleared before; however, we may
-- 
2.19.1

